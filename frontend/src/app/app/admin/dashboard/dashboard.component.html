<div class="w-full bg-white">
  <div class="flex h-screen overflow-hidden">
    <app-sidebar class="bg-blue-800 text-white"></app-sidebar>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col overflow-hidden">
      <!-- Top Navigation -->
      <app-admin-header></app-admin-header>
      
      <!-- Main Content Area -->
      <main class="flex-1 overflow-x-hidden overflow-y-auto bg-blue-50">
        <div class="container mx-auto px-4 py-6">
          <!-- Dashboard Header -->
          <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
            <div>
              <h1 class="text-2xl font-bold text-blue-900">Dashboard Overview</h1>
              <p class="text-blue-700">Welcome back, Admin! Here's what's happening with your platform today.</p>
            </div>
            <div class="mt-4 md:mt-0">
              <div class="flex items-center space-x-3">
                <div class="relative">
                  <select 
                    class="block appearance-none bg-white border border-blue-300 text-blue-700 py-2 px-4 pr-8 rounded-lg leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-colors duration-200"
                    [(ngModel)]="selectedTimeRange" 
                    (change)="updateTimeRange(selectedTimeRange)"
                    aria-label="Select time range"
                  >
                    <option value="7days">Last 7 Days</option>
                    <option value="30days">Last 30 Days</option>
                    <option value="90days">Last 90 Days</option>
                  </select>
                  <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-blue-600">
                    <i class="fas fa-chevron-down text-sm"></i>
                  </div>
                </div>
                <button 
                  class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg flex items-center transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                  (click)="refreshData()"
                  [disabled]="isRefreshing"
                  aria-label="Refresh data"
                >
                  <i class="fas fa-sync-alt mr-2" [class.animate-spin]="isRefreshing"></i>
                  <span>{{ isRefreshing ? 'Refreshing...' : 'Refresh' }}</span>
                </button>
                <button 
                  class="bg-white border border-blue-300 hover:bg-blue-50 text-blue-700 py-2 px-4 rounded-lg flex items-center transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                  aria-label="Filter data"
                >
                  <i class="fas fa-filter mr-2"></i>
                  <span>Filter</span>
                </button>
              </div>
            </div>
          </div>
          
          <!-- Summary Cards Grid -->
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div 
              *ngFor="let card of summaryCards" 
              class="bg-white rounded-xl shadow-sm p-6 border border-blue-100 hover:shadow-md transition-all duration-200"
              [attr.aria-label]="card.title + ' card'"
            >
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-blue-600 text-sm font-medium">{{ card.title }}</p>
                  <h3 class="text-2xl font-bold text-blue-900 mt-1">{{ formatNumber(card.value) }}</h3>
                  <div class="flex items-center mt-2">
                    <span 
                      class="text-sm font-medium flex items-center" 
                      [class.text-green-600]="card.isPositive" 
                      [class.text-red-600]="!card.isPositive"
                    >
                      <i class="fas mr-1" [class.fa-arrow-up]="card.isPositive" [class.fa-arrow-down]="!card.isPositive"></i> 
                      {{ card.change }}%
                    </span>
                    <span class="text-blue-500 text-sm ml-2">vs last month</span>
                  </div>
                </div>
                <div class="rounded-full p-3" [ngClass]="card.iconBg">
                  <i [ngClass]="card.icon" class="text-white text-xl"></i>
                </div>
              </div>
              <div class="mt-4">
                <div class="h-1.5 w-full bg-blue-100 rounded-full">
                  <div 
                    class="h-1.5 rounded-full bg-blue-500 transition-all duration-500" 
                    [style.width.%]="card.progress"
                  ></div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Charts Row 1 -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Daily Logins Chart -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-blue-100">
              <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-3">
                <h2 class="text-lg font-semibold text-blue-900">Daily Logins (Last 7 Days)</h2>
                <div class="flex items-center space-x-2">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                    <i class="fas fa-circle mr-1" style="font-size: 6px;"></i> Current Period
                  </span>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-50 text-blue-700">
                    <i class="fas fa-circle mr-1" style="font-size: 6px;"></i> Previous Period
                  </span>
                  <button 
                    id="loginChartZoom" 
                    class="text-blue-600 hover:text-blue-800 focus:outline-none"
                    aria-label="Expand login chart"
                  >
                    <i class="fas fa-expand"></i>
                  </button>
                </div>
              </div>
              <div class="chart-container" style="position: relative; height: 300px;">
                <canvas #loginChart aria-label="Daily logins chart" role="img"></canvas>
              </div>
              <div class="mt-4 flex flex-col space-y-3">
                <div class="flex justify-between items-center flex-wrap gap-2">
                  <div class="grid grid-cols-4 gap-2">
                    <button 
                      *ngFor="let week of ['week1', 'week2', 'week3', 'week4']" 
                      [id]="'loginChart' + week" 
                      class="px-3 py-1 text-xs rounded-lg hover:bg-blue-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1"
                      [class.bg-blue-100]="selectedWeek === week" 
                      [class.text-blue-800]="selectedWeek === week"
                      [class.bg-blue-50]="selectedWeek !== week" 
                      [class.text-blue-600]="selectedWeek !== week"
                      (click)="updateWeek($any(week))"
                      [attr.aria-label]="'Show week ' + week.slice(-1) + ' data'"
                    >
                      Week {{ week.slice(-1) }}
                    </button>
                  </div>
                </div>
                <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center text-sm text-blue-500 gap-1">
                  <span>Avg: {{ weeklyData[selectedWeek].avg }} logins/day</span>
                  <span class="hidden sm:inline">|</span>
                  <span>Total: {{ formatNumber(weeklyData[selectedWeek].total) }} logins</span>
                </div>
              </div>
            </div>
            
            <!-- Applications vs Hires Chart -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-blue-100">
              <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-3">
                <h2 class="text-lg font-semibold text-blue-900">
                  Applications vs Hires (Last {{ selectedTimeRange === '7days' ? '7' : selectedTimeRange === '30days' ? '30' : '90' }} Days)
                </h2>
                <div class="relative">
                  <select 
                    class="block appearance-none bg-white border border-blue-300 text-blue-700 py-1 px-3 pr-8 rounded-lg leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors duration-200"
                    [(ngModel)]="selectedTimeRange" 
                    (change)="updateTimeRange(selectedTimeRange)"
                    aria-label="Select time range for applications chart"
                  >
                    <option value="7days">Last 7 Days</option>
                    <option value="30days">Last 30 Days</option>
                    <option value="90days">Last 90 Days</option>
                  </select>
                  <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-blue-600">
                    <i class="fas fa-chevron-down text-xs"></i>
                  </div>
                </div>
              </div>
              <div class="chart-container" style="position: relative; height: 300px;">
                <canvas #applicationsChart aria-label="Applications vs hires chart" role="img"></canvas>
              </div>
              <div class="mt-4 flex flex-col sm:flex-row sm:justify-between items-start sm:items-center gap-2">
                <div class="flex items-center space-x-4">
                  <div class="flex items-center">
                    <span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>
                    <span class="text-xs text-blue-700">Applications</span>
                  </div>
                  <div class="flex items-center">
                    <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                    <span class="text-xs text-blue-700">Hires</span>
                  </div>
                </div>
                <div class="text-sm text-blue-500">
                  <span>Conversion Rate: {{ timeRangeData[selectedTimeRange].conversion }}%</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Charts Row 2 -->
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <!-- User Activity Status -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-blue-100">
              <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-blue-900">User Activity Status</h2>
              </div>
              <div class="chart-container" style="position: relative; height: 250px;">
                <canvas #userActivityChart aria-label="User activity chart" role="img"></canvas>
              </div>
              <div class="mt-4 space-y-2">
                <div class="flex items-center justify-between">
                  <div class="flex items-center">
                    <span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>
                    <span class="text-sm text-blue-700">Active: {{ formatNumber(userActivityData.active) }}</span>
                  </div>
                  <span class="text-sm font-medium text-blue-900">
                    {{ (userActivityData.active / (userActivityData.active + userActivityData.inactive + userActivityData.newToday) * 100).toFixed(1) }}%
                  </span>
                </div>
                <div class="flex items-center justify-between">
                  <div class="flex items-center">
                    <span class="w-3 h-3 bg-pink-500 rounded-full mr-2"></span>
                    <span class="text-sm text-blue-700">Inactive: {{ formatNumber(userActivityData.inactive) }}</span>
                  </div>
                  <span class="text-sm font-medium text-blue-900">
                    {{ (userActivityData.inactive / (userActivityData.active + userActivityData.inactive + userActivityData.newToday) * 100).toFixed(1) }}%
                  </span>
                </div>
                <div class="flex items-center justify-between">
                  <div class="flex items-center">
                    <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                    <span class="text-sm text-blue-700">New Today: {{ formatNumber(userActivityData.newToday) }}</span>
                  </div>
                  <span class="text-sm font-medium text-blue-900">
                    {{ (userActivityData.newToday / (userActivityData.active + userActivityData.inactive + userActivityData.newToday) * 100).toFixed(1) }}%
                  </span>
                </div>
              </div>
            </div>
            
            <!-- Job Categories Distribution -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-blue-100">
              <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-blue-900">Job Categories</h2>
              </div>
              <div class="h-64 flex items-end space-x-6 px-4 border-b border-blue-200 pb-4">
                <div *ngFor="let category of jobCategories" class="flex-1 flex flex-col items-center">
                  <div class="w-full relative">
                    <div 
                      class="mx-auto transition-all duration-500" 
                      [ngStyle]="{
                        'background-color': category.color + '20',
                        'width': '80%',
                        'height': '0',
                        'padding-bottom': (category.value * 0.7) + '%',
                        'border-radius': '50% 50% 0 0',
                        'clip-path': 'ellipse(50% 100% at 50% 100%)'
                      }"
                    ></div>
                    <div 
                      class="absolute bottom-0 left-1/2 transform -translate-x-1/2 w-px transition-all duration-500" 
                      [ngStyle]="{
                        'background-color': category.color,
                        'height': (category.value * 0.7) + '%'
                      }"
                    ></div>
                  </div>
                  <span class="text-xs mt-2 font-medium transition-all duration-500" [ngStyle]="{ 'color': category.color }">
                    {{ category.value }}%
                  </span>
                  <span class="text-xs text-blue-700">{{ category.name }}</span>
                </div>
              </div>
              <div class="mt-4 space-y-2">
                <div *ngFor="let category of jobCategories" class="flex items-center justify-between">
                  <div class="flex items-center">
                    <span class="w-3 h-3 rounded-full mr-2" [ngStyle]="{ 'background-color': category.color }"></span>
                    <span class="text-sm text-blue-900">{{ category.name }}</span>
                  </div>
                  <span class="text-sm font-medium text-blue-900">{{ category.value }}%</span>
                </div>
              </div>
            </div>
            
            <!-- Platform Performance -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-blue-100">
              <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-blue-900">Platform Performance</h2>
                <div class="flex items-center space-x-2">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    <i class="fas fa-circle mr-1" style="font-size: 6px;"></i>
                    Operational
                  </span>
                </div>
              </div>
              <div class="space-y-4">
                <div *ngFor="let metric of platformPerformance">
                  <div class="flex items-center justify-between mb-1">
                    <span class="text-sm font-medium text-blue-900">{{ metric.metric }}</span>
                    <span class="text-sm font-bold text-blue-900">{{ metric.value }}</span>
                  </div>
                  <div class="w-full bg-blue-100 rounded-full h-2">
                    <div 
                      class="h-2 rounded-full transition-all duration-500" 
                      [ngClass]="metric.color" 
                      [style.width.%]="metric.percentage"
                    ></div>
                  </div>
                </div>
              </div>
              <div class="mt-6">
                <div class="grid grid-cols-2 gap-4">
                  <div class="bg-blue-50 p-3 rounded-lg text-center hover:bg-blue-100 transition-colors duration-200">
                    <p class="text-xs text-blue-600">Active Sessions</p>
                    <p class="text-xl font-bold text-blue-800">1,248</p>
                  </div>
                  <div class="bg-green-50 p-3 rounded-lg text-center hover:bg-green-100 transition-colors duration-200">
                    <p class="text-xs text-green-600">Peak Today</p>
                    <p class="text-xl font-bold text-green-700">2,156</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Recent Activity & Top Users -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Recent Activity -->
            <div class="bg-white rounded-xl shadow-sm border border-blue-100">
              <div class="p-6 border-b border-blue-200">
                <h2 class="text-lg font-semibold text-blue-900">Recent Activity</h2>
              </div>
              <div class="divide-y divide-blue-100">
                <div 
                  *ngFor="let activity of recentActivity" 
                  class="p-4 hover:bg-blue-50 transition-colors duration-150"
                  tabindex="0"
                  (keyup.enter)="navigateToActivity(activity)"
                >
                  <div class="flex items-start">
                    <div class="flex-shrink-0 rounded-full p-2" [ngClass]="activity.iconBg">
                      <i [ngClass]="activity.icon" class="text-white"></i>
                    </div>
                    <div class="ml-3">
                      <p class="text-sm font-medium text-blue-900">{{ activity.title }}</p>
                      <p class="text-sm text-blue-700">{{ activity.description }}</p>
                      <p class="text-xs text-blue-500 mt-1">{{ activity.time }}</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="p-4 border-t border-blue-200 text-center">
                <a 
                  href="#" 
                  class="text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors duration-200 focus:outline-none focus:underline"
                  aria-label="View all activity"
                >
                  View all activity
                </a>
              </div>
            </div>
            
            <!-- Top Users -->
            <div class="bg-white rounded-xl shadow-sm border border-blue-100">
              <div class="p-6 border-b border-blue-200">
                <div class="flex items-center justify-between">
                  <h2 class="text-lg font-semibold text-blue-900">Top Users This Month</h2>
                  <button 
                    class="text-sm text-blue-600 hover:text-blue-800 transition-colors duration-200 focus:outline-none focus:underline"
                    aria-label="View all top users"
                  >
                    View All
                  </button>
                </div>
              </div>
              <div class="divide-y divide-blue-100">
                <div 
                  *ngFor="let user of topUsers" 
                  class="p-4 hover:bg-blue-50 transition-colors duration-150"
                  tabindex="0"
                  (keyup.enter)="navigateToUserProfile(user)"
                >
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <img 
                        class="h-10 w-10 rounded-full object-cover" 
                        [src]="user.image" 
                        [alt]="user.name + ' profile picture'"
                        width="40"
                        height="40"
                      >
                    </div>
                    <div class="ml-4 flex-1">
                      <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-blue-900">{{ user.name }}</p>
                        <p class="text-sm font-bold text-blue-600">{{ user.points }} pts</p>
                      </div>
                      <div class="flex items-center mt-1">
                        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium" [ngClass]="user.roleColor">
                          {{ user.role }}
                        </span>
                        <span class="ml-2 text-xs text-blue-500">{{ user.connections }} connections</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Recent Jobs Table -->
          <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-blue-100 mb-6">
            <div class="px-6 py-4 border-b border-blue-200 flex items-center justify-between">
              <h2 class="text-lg font-semibold text-blue-900">Recent Job Postings</h2>
              <button 
                class="text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors duration-200 focus:outline-none focus:underline"
                aria-label="View all jobs"
              >
                View All Jobs
              </button>
            </div>
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-blue-100">
                <thead class="bg-blue-50">
                  <tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">Job Title</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">Company</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">Category</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">Applications</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">Status</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">Posted</th>
                    <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-blue-700 uppercase tracking-wider">Action</th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-blue-100">
                  <tr 
                    *ngFor="let job of recentJobs" 
                    class="hover:bg-blue-50 transition-colors duration-150"
                    tabindex="0"
                    (keyup.enter)="navigateToJobDetails(job)"
                  >
                    <td class="px-6 py-4 whitespace-nowrap">
                      <div class="text-sm font-medium text-blue-900">{{ job.title }}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <div class="flex items-center">
                        <div class="flex-shrink-0 h-10 w-10">
                          <img 
                            class="h-10 w-10 rounded-full object-cover" 
                            [src]="job.logo" 
                            [alt]="job.company + ' logo'"
                            width="40"
                            height="40"
                          >
                        </div>
                        <div class="ml-4">
                          <div class="text-sm font-medium text-blue-900">{{ job.company }}</div>
                          <div class="text-sm text-blue-700">{{ job.location }}</div>
                        </div>
                      </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full" [ngClass]="job.categoryColor">
                        {{ job.category }}
                      </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-blue-700">{{ job.applications }}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full" [ngClass]="job.statusColor">
                        {{ job.status }}
                      </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-blue-700">{{ job.posted }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                      <a 
                        href="#" 
                        class="text-blue-600 hover:text-blue-800 transition-colors duration-200 focus:outline-none focus:underline"
                        aria-label="View job details"
                      >
                        View
                      </a>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="px-6 py-4 border-t border-blue-200 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
              <div class="text-sm text-blue-600">Showing <span class="font-medium">1</span> to <span class="font-medium">5</span> of <span class="font-medium">24</span> results</div>
              <div class="flex space-x-2">
                <button 
                  class="px-3 py-1 border border-blue-300 rounded-lg text-sm font-medium text-blue-700 bg-white hover:bg-blue-50 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1"
                  aria-label="Previous page"
                >
                  Previous
                </button>
                <button 
                  class="px-3 py-1 border border-blue-300 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1"
                  aria-label="Next page"
                >
                  Next
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>
      
      <!-- Footer -->
      <app-admin-footer></app-admin-footer>
    </div>
  </div>
</div>

<!-- Floating Action Button -->
<button 
  class="fixed bottom-6 right-6 bg-blue-600 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg hover:bg-blue-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
  (click)="navigateToManageJobs()"
  aria-label="Create new job"
>
  <i class="fas fa-plus text-xl"></i>
</button>